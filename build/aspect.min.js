!function(a){function d(a,b){var c={};return c.id=a,c.advice=b?b:{},c.pointCut=d.pointCut,c._wrapperFunc=d._wrapperFunc,c}var c,b={};b.isType=function(a){return function(b){return{}.toString.call(b)=="[object "+a+"]"}},b.isObject=b.isType("Object"),b.isString=b.isType("String"),b.isArray=Array.isArray||b.isType("Array"),b.isFunction=b.isType("Function"),b.isUndefined=b.isType("Undefined"),b.isInArray=function(a,b){for(i=0;i<a.length;i++)if(a[i]==b)return!0;return!1},b.extend=function(a,c,d,e){var f;if(!c)return a;b.isArray(d)&&(e=d,d=!1),b.isArray(e)&&0==e.length&&(e=!1);for(f in c)(!b.isArray(e)||b.isInArray(e,f))&&a!==c[f]&&(b.isObject(c[f])&&d&&(a[f]||(a[f]={}),b.extend(a[f],c[f],d)),a[f]=c[f]);return a},c={events:{},contexts:{}},c.on=function(a,b){var d=this.events[a]||(this.events[a]=[]);return d.push(b),this},c.one=function(a,b){var c=this,d=function(e){c.off(a,d),b.call(c,e)};return c.on(a,d),this},c.emit=function(a,b){var d,e,c=this.events[a];if(c)for(c=c.slice(),d=0,e=c.length;e>d;d++)c[d](b);return this},c.off=function(a,b){var c,d;if(!a&&!b)return this.events={},this;if(c=this.events[a])if(b)for(d=c.length-1;d>=0;d--)c[d]===b&&c.splice(d,1);else delete this.events[a];return this},d.getMethodName=function(a){return a.name||a.toString().match(/function\s*([^(]*)\(/)[1]},d.getClassName=function(a){return d.getMethodName(a.constructor)},d.pointCut=function(c,d){var e,f;if(1==arguments.length)if(b.isObject(c)){d=[];for(p in c)b.isFunction(c[p])&&d.push(p)}else d=c,c=a;for(b.isString(d)&&(d=[d]),e=0;e<d.length;e++)f=d[e],c[f]=this._wrapperFunc(c,f)},d._exclused=["before","after","around","throwing"],d._wrapperFunc=function(a,e){var h,f=a[e],g=b.extend({},this.advice);return a._eventAdvices||(a._eventAdvices={}),a._eventAdvices[e]||(a._eventAdvices[e]=b.extend({},c,!0)),h=a._eventAdvices[e],function(){for(p in g)b.isFunction(g[p])&&!b.isInArray(d._exclused,p)&&h.on(p,function(a){g.joinPoint.eventDatas[p]=a,g[p].call(g,g.joinPoint)});try{var c={context:a,contextName:d.getClassName(a),target:f,targetName:e,arguments:arguments,result:"",error:"",stop:!1,eventDatas:{}};if(g.joinPoint=c,h.joinPoint||(h.joinPoint=c),g.before&&(g.before(c),c.stop))return;if(g.around){if(g.around(c),c.stop)return}else c.result=f.apply(a,arguments);if(g.after&&(g.after(c),c.stop))return}catch(i){g.throwing&&g.throwing(c)}return c.result}},a.Aspect=d}(this);